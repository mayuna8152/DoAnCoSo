@model DoAnCoSo.Models.PostViewModel
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - DoAnCoSo</title>
	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/mystyle.css" asp-append-version="true" />
	<link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
	<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body>

	<h1>Index</h1>
	<div class="popup">
		<!-- Trigger/Open The Modal -->
		<button id="mbtn" class="btn btn-primary turned-button">Add post</button>

		<!-- The Modal -->
		<div id="modalDialog" class="modal">
			<div class="modal-content animate-top">
				<div class="modal-header">
					<h5 class="modal-title">Add post</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<form method="post" asp-action="Create" enctype="multipart/form-data">
						<div asp-validation-summary="ModelOnly" class="text-danger"></div>
						<div class="form-group">
							<label asp-for="Post.Title" class="control-label"></label>
							<input asp-for="Post.Title" class="form-control" />
							<span asp-validation-for="Post.Title" class="text-danger"></span>
						</div>
						<div class="form-group">
							<label asp-for="Post.ImageQRVideo" class="control-label"></label>
							<input asp-for="Post.ImageQRVideo" type="file" class="form-control" name="imageQRVideo" onchange="previewImage(event)" />
							<span asp-validation-for="Post.ImageQRVideo" class="text-danger"></span>
						</div>
						<div class="form-group">
							<input type="hidden" asp-for="Post.Date" value="@DateTime.Now" />
						</div>
						<input type="submit" value="Create" class="btn btn-primary" />
						<div class="col-md-4">
							<img id="imagePreview" class="img-fluid" alt="Image Preview" style="display: none;" />
						</div>

					</form>

				</div>
			</div>
		</div>
	</div>
	<table class="table">
		<thead>
			<tr>
				<th>
					Title
				</th>
				<th>
					Date
				</th>
				<th>
					ImageQRVideo
				</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			@foreach (var item in Model.Posts)
			{
				<tr>
					<td>
						@Html.DisplayFor(modelItem => item.Title)
					</td>
					<td>
						@Html.DisplayFor(modelItem => item.Date)
					</td>
					<td>
						@Html.DisplayFor(modelItem => item.ImageQRVideo)
					</td>
					<td>
						<a asp-action="Details" asp-route-id="@item.IdPost">Details</a>
					</td>
				</tr>
			}
		</tbody>
		@section Scripts {
			<script>
				function previewImage(event) {
					var input = event.target;
					if (input.files && input.files[0]) {
						var reader = new FileReader();
						reader.onload = function (e) {
							document.getElementById('imagePreview').src = e.target.result;
							document.getElementById('imagePreview').style.display = 'block';
						};
						reader.readAsDataURL(input.files[0]);
					}
				}
			</script>
			@{
				await Html.RenderPartialAsync("_ValidationScriptsPartial");
			}
		}
	</table>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		/*
		 * Modal popup
		 */
		// Get the modal
		var modal = $('#modalDialog');

		// Get the button that opens the modal
		var btn = $("#mbtn");

		// Get the element that closes the modal
		var span = $(".close");

		$(document).ready(function () {
			// When the user clicks the button, open the modal
			btn.on('click', function () {
				modal.show();
			});

			// When the user clicks on (x), close the modal
			span.on('click', function () {
				modal.hide();
			});
		});

		// When the user clicks anywhere outside of the modal, close it
		$('body').bind('click', function (e) {
			if ($(e.target).hasClass("modal")) {
				modal.hide();
			}
		});
	</script>
</body>
</html>